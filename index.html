<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> InventaVal - Sistema de Inventario</title>
    <link rel="stylesheet" href="estilos.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"></script>
    <script src="inventario.js"></script>
    <style>
        /* Estilos cr铆ticos iniciales */
        :root {
            --verde-comeval: #2e7d32;
            --verde-claro: #4caf50;
            --naranja-comeval: #ff9800;
            --naranja-claro: #ffb74d;
            --blanco-5: #f8f9fa;
            --texto-oscuro: #333333;
            --gris-borde: #dee2e6;
        }
        
        .oculto { display: none !important; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: var(--blanco-5);
            color: var(--texto-oscuro);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <!-- ========== HEADER VERDE ========== -->
    <header class="header-verde">
        <div class="container">
            <div class="logo-titulo">
                <div class="logo">
                    <i class="fas fa-warehouse"></i>
                </div>
                <div class="titulo">
                    <h1>INVENTAVAL</h1>
                    <p class="subtitulo">Sistema Profesional de Inventario</p>
                </div>
            </div>
            
            <div class="header-info">
                <div class="info-item" id="infoUsuario">
                    <i class="fas fa-user"></i>
                    <span>No logueado</span>
                </div>
                <div class="info-item" id="infoProductos">
                    <i class="fas fa-boxes"></i>
                    <span>0 productos</span>
                </div>
            </div>
        </div>
    </header>

    <!-- ========== BARRA HERRAMIENTAS ========== -->
    <nav class="barra-herramientas">
        <div class="container">
            <div class="herramientas-izq" id="herramientasVisita">
                <button onclick="mostrarLogin()" class="btn-herramienta btn-login">
                    <i class="fas fa-sign-in-alt"></i> Acceder al Sistema
                </button>
            </div>
            
            <div class="herramientas-der oculto" id="herramientasAdmin">
                <div class="grupo-herramientas">
                    <button onclick="agregarProducto()" class="btn-herramienta btn-accion">
                        <i class="fas fa-plus-circle"></i> Nuevo Producto
                    </button>
                    
                    <div class="dropdown">
                        <button class="btn-herramienta btn-accion">
                            <i class="fas fa-sort"></i> Ordenar
                        </button>
                        <div class="dropdown-contenido">
                            <a onclick="ordenarPor('marca')"><i class="fas fa-tag"></i> Por Marca</a>
                            <a onclick="ordenarPor('vencimiento')"><i class="fas fa-calendar-alt"></i> Por Vencimiento</a>
                            <a onclick="ordenarPor('inteligente')"><i class="fas fa-brain"></i> Inteligente</a>
                            <a onclick="ordenarPor('nombre')"><i class="fas fa-font"></i> Por Nombre</a>
                        </div>
                    </div>
                    
                    <div class="dropdown">
                        <button class="btn-herramienta btn-accion">
                            <i class="fas fa-file-export"></i> Exportar
                        </button>
                        <div class="dropdown-contenido">
                            <a onclick="exportarAPDF()"><i class="fas fa-file-pdf"></i> PDF para Imprimir</a>
                            <a onclick="exportarAExcel()"><i class="fas fa-file-excel"></i> Excel (.xlsx)</a>
                            <a onclick="exportarAImagen()"><i class="fas fa-image"></i> Imagen (.png)</a>
                            <a onclick="imprimirDirecto()"><i class="fas fa-print"></i> Imprimir Directo</a>
                        </div>
                    </div>
                    
                    <button onclick="generarCodigoRespaldo()" class="btn-herramienta btn-accion">
                        <i class="fas fa-key"></i> C贸digo Respaldo
                    </button>
                    
                    <button onclick="mostrarImportarInventario()" class="btn-herramienta btn-accion">
                        <i class="fas fa-file-import"></i> Importar
                    </button>
                    
                    <button onclick="cerrarSesion()" class="btn-herramienta btn-logout">
                        <i class="fas fa-sign-out-alt"></i> Salir
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- ========== CONTENIDO PRINCIPAL ========== -->
    <main class="contenido-principal">
        <div class="container">
            <!-- MODO VISITA (SOLO LECTURA) -->
            <section id="modoVisita" class="seccion-inventario">
                <div class="seccion-cabecera">
                    <h2><i class="fas fa-eye"></i> Vista de Inventario</h2>
                    <p class="descripcion">Modo de solo lectura. Para modificar productos, accede al sistema.</p>
                </div>
                
                <div id="tablaInventario" class="contenedor-tabla">
                    <!-- Tabla se carga por JavaScript -->
                </div>
                
                <div class="paginacion" id="paginacionVisita">
                    <!-- Paginaci贸n se genera por JavaScript -->
                </div>
            </section>
            
            <!-- MODO ADMIN (EDICIN) -->
            <section id="modoAdmin" class="seccion-inventario oculto">
                <div class="seccion-cabecera">
                    <h2><i class="fas fa-edit"></i> Modo de Edici贸n</h2>
                    <div class="estadisticas">
                        <span id="contadorProductos">0 productos</span>
                        <span id="contadorPaginas">P谩gina 1 de 1</span>
                    </div>
                </div>
                
                <div class="filtros-busqueda">
                    <div class="buscador">
                        <i class="fas fa-search"></i>
                        <input type="text" id="buscarProducto" placeholder="Buscar producto..." 
                               onkeyup="filtrarProductos()">
                    </div>
                    <div class="filtros">
                        <select id="filtroMarca" onchange="filtrarProductos()">
                            <option value="">Todas las marcas</option>
                        </select>
                        <select id="filtroVencimiento" onchange="filtrarProductos()">
                            <option value="">Todos los vencimientos</option>
                            <option value="proximo">Pr贸ximos a vencer</option>
                            <option value="vencido">Vencidos</option>
                        </select>
                    </div>
                </div>
                
                <div id="tablaInventarioAdmin" class="contenedor-tabla">
                    <!-- Tabla editable se carga por JavaScript -->
                </div>
                
                <div class="paginacion" id="paginacionAdmin">
                    <!-- Paginaci贸n se genera por JavaScript -->
                </div>
            </section>
            
            <!-- FORMULARIO LOGIN -->
            <section id="loginForm" class="seccion-login oculto">
                <div class="login-contenedor">
                    <div class="login-cabecera">
                        <h2><i class="fas fa-lock"></i> Acceso al Sistema</h2>
                        <p>Ingresa tus credenciales para administrar el inventario</p>
                    </div>
                    
                    <div class="login-formulario">
                        <div class="input-grupo">
                            <i class="fas fa-user"></i>
                            <input type="text" id="usuario" placeholder="Nombre de usuario" autocomplete="username">
                        </div>
                        
                        <div class="input-grupo">
                            <i class="fas fa-key"></i>
                            <input type="password" id="clave" placeholder="Contrase帽a" autocomplete="current-password">
                        </div>
                        
                        <div class="login-botones">
                            <button onclick="verificarCredenciales()" class="btn-login-form">
                                <i class="fas fa-door-open"></i> Iniciar Sesi贸n
                            </button>
                            <button onclick="regresarAVisita()" class="btn-cancelar">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                        </div>
                    </div>
                    
                    <div class="login-info">
                        <h3><i class="fas fa-info-circle"></i> Credenciales de Prueba</h3>
                        <div class="credenciales">
                            <div class="credencial">
                                <strong>Administrador:</strong>
                                <code>admin</code> / <code>123</code>
                            </div>
                            <div class="credencial">
                                <strong>Usuario 1:</strong>
                                <code>fulano</code> / <code>abc</code>
                            </div>
                            <div class="credencial">
                                <strong>Usuario 2:</strong>
                                <code>mengano</code> / <code>xyz</code>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- HISTORIAL DE CAMBIOS -->
            <section id="historialContainer" class="seccion-historial oculto">
                <div class="seccion-cabecera">
                    <h2><i class="fas fa-history"></i> Historial de Cambios</h2>
                    <button onclick="toggleHistorial()" class="btn-cerrar-historial">
                        <i class="fas fa-times"></i> Cerrar Historial
                    </button>
                </div>
                <div id="historial" class="lista-historial">
                    <!-- Historial se carga por JavaScript -->
                </div>
            </section>
        </div>
    </main>

    <!-- ========== FOOTER NARANJA ========== -->
    <footer class="footer-naranja">
        <div class="container">
            <div class="footer-contenido">
                <div class="footer-info">
                    <h3>INVENTAVAL v2.0</h3>
                    <p>Sistema profesional de gesti贸n de inventario</p>
                    <p class="footer-dato" id="fechaActual">Cargando fecha...</p>
                </div>
                
                <div class="footer-estadisticas">
                    <div class="estadistica">
                        <i class="fas fa-database"></i>
                        <div>
                            <span class="valor" id="footerTotalProductos">0</span>
                            <span class="etiqueta">Productos</span>
                        </div>
                    </div>
                    <div class="estadistica">
                        <i class="fas fa-exchange-alt"></i>
                        <div>
                            <span class="valor" id="footerTotalMovimientos">0</span>
                            <span class="etiqueta">Movimientos</span>
                        </div>
                    </div>
                    <div class="estadistica">
                        <i class="fas fa-user-clock"></i>
                        <div>
                            <span class="valor" id="footerSesionActiva">No</span>
                            <span class="etiqueta">Sesi贸n Activa</span>
                        </div>
                    </div>
                </div>
                
                <div class="footer-acciones">
                    <button onclick="mostrarAcercaDe()" class="btn-footer">
                        <i class="fas fa-info-circle"></i> Acerca de
                    </button>
                    <button onclick="exportarComoArchivo()" class="btn-footer">
                        <i class="fas fa-download"></i> Exportar JSON
                    </button>
                </div>
            </div>
            
            <div class="footer-copyright">
                <p>漏 2024 InventaVal - Todos los derechos reservados</p>
                <p class="version">Versi贸n: 2.0.0 Esaa Jocsuel | ltima actualizaci贸n: <span id="fechaActualizacion"></span></p>
            </div>
        </div>
    </footer>

    <!-- ========== MODALES (SE INSERTAN POR JS) ========== -->
    <div id="modalesContainer"></div>

    <!-- ========== NOTIFICACIONES (SE INSERTAN POR JS) ========== -->
    <div id="notificacionesContainer"></div>

    <!-- ========== JAVASCRIPT ========== -->
    
    <!-- Scripts de inicializaci贸n -->
    <script>
        // Actualizar fecha en footer
        document.addEventListener('DOMContentLoaded', function() {
            const fecha = new Date();
            const opciones = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('fechaActual').textContent = 
                fecha.toLocaleDateString('es-VE', opciones);
            
            document.getElementById('fechaActualizacion').textContent = 
                fecha.toLocaleDateString('es-VE');
            
            console.log(' InventaVal - Sistema cargado correctamente');
        });
    </script>
    <!-- Agr茅galo JUSTO ANTES del </body> en tu HTML -->
<div id="debugPanel" style="position: fixed; bottom: 0; left: 0; right: 0; background: red; color: white; padding: 10px; z-index: 9999; display: none;">
    <div id="debugContent"></div>
    <button onclick="document.getElementById('debugPanel').style.display = 'none'" style="float: right;">X</button>
</div>

<script>
</script>
</body>
    </html>
